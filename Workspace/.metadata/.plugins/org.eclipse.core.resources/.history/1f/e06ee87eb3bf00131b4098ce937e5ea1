package view;

import java.io.File;
import java.util.List;

import model.GameState;
import model.PlayerStatistics;

public class OutputFileWriter extends OutputWriter {
	private File file;
	
	public OutputFileWriter(String path) {
		this.file = new File(path);
	}
	
	public OutputFileWriter(File file) {
		this.file = file;
	}
	
	@Override
	public void write(String comment, PlayerStatistics player1Statistics,
			PlayerStatistics player2Statistics)
	{
		int numberOfAllGames = player1Statistics.wonGames + player2Statistics.wonGames;
		List<GameState> anyGame = (player1Statistics.wonGame != null ? player1Statistics.wonGame : player2Statistics.wonGame);
		long percentage1 = Math.round((player1Statistics.wonGames * 100.0) / numberOfAllGames);
		long percentage2 = Math.round((player2Statistics.wonGames * 100.0) / numberOfAllGames);
		StringBuilder sb = new StringBuilder(comment);
		// TODO implement writing to file
		sb.append("Startverteilung: " + anyGame.get(0) + "\n");
		sb.append("Gewonnene Spiele Spieler 1: " + percentage1 + " %\n");
		sb.append("Gewonnene Spiele Spieler 2: " + percentage2 + " %\n");
		sb.append();
		
		createExample(1, player1Statistics.wonGame);
		createExample(2, player2Statistics.wonGame);
		
	}
	
	private String createExample(int playerNumber, List<GameState> game) {
		StringBuilder sb = new StringBuilder("Beispiel eines von Spieler " + playerNumber + " gewonnenen Spiels:\n");
		
		if(game != null) {
			String firstState, secondState;
			
			for(int count = 1; count < game.size(); ++count)
			{
				firstState = game.get(count-1).toString();
				secondState = game.get(count).toString();
				playerNumber = (1 + ((count-1) % 2));
				
				sb.append("Zug " + count + ", Spieler " + playerNumber + " : " + firstState + " -> " + secondState + "\n");
			}
		} else {
			sb.append("Nicht vorhanden.");
		}
		
		return sb.toString();
	}

}
